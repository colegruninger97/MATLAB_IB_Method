function w = IB6x_prime(r,K)
%interpolation in the x direction using the IB6 kernel family parameterized
%by the constant K. 
w = zeros(1,6);

if r<0 || r > 1
    msg = 'r must be between zero and 1.';
    error(msg);
end

%first compute the constants beta and gamma
w(1,6) = (1/56).*((-22/3)+7.*K+3.*r+7.*r.^2+(1/2).*(2.*((22/3)+(-7).*K+(-3) ...
  .*r+(-7).*r.^2).*((9/4)+((22/3)+(-7).*K).*r+(-7/3).*r.^3+(-3/2).*( ...
  K+r.^2))+(-112).*((-11/16).*r+(3/16).*r.^3+(3/16).*r.*(2.*K+r.^2)+ ...
  (1/9).*(4+(-3).*K+(-3).*r.^2).*((4+(-3).*K).*r+(-1).*r.^3)+(1/36) ...
  .*((-1)+3.*K+3.*r.^2).*(((-1)+3.*K).*r+r.^3))).*(((9/4)+((22/3)+( ...
  -7).*K).*r+(-7/3).*r.^3+(-3/2).*(K+r.^2)).^2+(-112).*((-11/32).* ...
  r.^2+(3/32).*r.^2.*(2.*K+r.^2)+(1/18).*((4+(-3).*K).*r+(-1).*r.^3) ...
  .^2+(1/72).*(((-1)+3.*K).*r+r.^3).^2)).^(-1/2));
w(1,5) = (11/28)+(-3/8).*K+(1/12).*((-1)+3.*K)+(5/56).*r+(-1/8).*r.^2+( ...
  1/56).*((-1)+2.*r).*(198+126.*K.^2+((-1)+r).*r.*((-209)+42.*((-1)+ ...
  r).*r)+3.*K.*((-107)+56.*((-1)+r).*r)).*(81+12.*K.^2.*(3+(-28).*(( ...
  -1)+r).*r)+(-4/3).*((-1)+r).*r.*(396+((-1)+r).*r.*((-209)+28.*(( ...
  -1)+r).*r))+(-4).*K.*(27+2.*((-1)+r).*r.*((-107)+28.*((-1)+r).*r)) ...
  ).^(-1/2);
w(1,4) = (1/84).*(34+(-21).*K+9.*r+(-21).*r.^2+(-1).*((-1)+2.*r).*(198+ ...
  126.*K.^2+((-1)+r).*r.*((-209)+42.*((-1)+r).*r)+3.*K.*((-107)+56.* ...
  ((-1)+r).*r)).*(81+12.*K.^2.*(3+(-28).*((-1)+r).*r)+(-4/3).*((-1)+ ...
  r).*r.*(396+((-1)+r).*r.*((-209)+28.*((-1)+r).*r))+(-4).*K.*(27+ ...
  2.*((-1)+r).*r.*((-107)+28.*((-1)+r).*r))).^(-1/2));
w(1,3) = (1/336).*((-88)+84.*K+(-66).*r+28.*r.^2+2.*r.*((-33)+28.*r)+(-4).* ...
  ((-1)+2.*r).*(198+126.*K.^2+((-1)+r).*r.*((-209)+42.*((-1)+r).*r)+ ...
  3.*K.*((-107)+56.*((-1)+r).*r)).*(81+12.*K.^2.*(3+(-28).*((-1)+r) ...
  .*r)+(-4/3).*((-1)+r).*r.*(396+((-1)+r).*r.*((-209)+28.*((-1)+r).* ...
  r))+(-4).*K.*(27+2.*((-1)+r).*r.*((-107)+28.*((-1)+r).*r))).^( ...
  -1/2));
w(1,2) = (11/28)+(-3/8).*K+(1/6).*((-4)+3.*K)+(-9/56).*r+(1/8).*r.^2+(1/56) ...
  .*((-1)+2.*r).*(198+126.*K.^2+((-1)+r).*r.*((-209)+42.*((-1)+r).* ...
  r)+3.*K.*((-107)+56.*((-1)+r).*r)).*(81+12.*K.^2.*(3+(-28).*((-1)+ ...
  r).*r)+(-4/3).*((-1)+r).*r.*(396+((-1)+r).*r.*((-209)+28.*((-1)+r) ...
  .*r))+(-4).*K.*(27+2.*((-1)+r).*r.*((-107)+28.*((-1)+r).*r))).^( ...
  -1/2);
w(1,1) = (1/168).*((-8)+(-21).*K+51.*r+(-21).*r.^2+(-1).*((-1)+2.*r).*(198+ ...
  126.*K.^2+((-1)+r).*r.*((-209)+42.*((-1)+r).*r)+3.*K.*((-107)+56.* ...
  ((-1)+r).*r)).*(81+12.*K.^2.*(3+(-28).*((-1)+r).*r)+(-4/3).*((-1)+ ...
  r).*r.*(396+((-1)+r).*r.*((-209)+28.*((-1)+r).*r))+(-4).*K.*(27+ ...
  2.*((-1)+r).*r.*((-107)+28.*((-1)+r).*r))).^(-1/2));

end

